<!doctype html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout_classList}">

<head>
<meta charset="UTF-8">
<meta id="_csrf" name="_csrf" th:content="${_csrf.token}" />
<meta id="_csrf_header" name="_csrf_header"
	th:content="${_csrf.headerName}" />

<!--script src="http://code.jquery.com/jquery-latest.min.js"></script>   -->

<script>
document.addEventListener('DOMContentLoaded', function() {
	var token = $("meta[name='_csrf']").attr("content");
	var header = $("meta[name='_csrf_header']").attr("content");
	// ì •ë ¬
	orderby();
	function orderby(){
	$('#orderby').on('change', function(){
		$('#key').val($('#orderby').val());
		$('#getOrderBy').submit();
	})
	}
	
	// 1016 ì„ í¬ ì¶”ê°€(ë§ˆì´í˜ì´ì§€ ìœ„ì‹œë¦¬ìŠ¤íŠ¸ì— ë“±ë¡)
	// ìŠ¤í¬ë© í•˜íŠ¸ë²„íŠ¼ í´ë¦­ì‹œ
	$("#all").on('click','.scrapBtn', function() {
		let categoryId = $(this).children().val(); // í´ë˜ìŠ¤ ì¹´í…Œê³ ë¦¬ c
		// console.log(categoryId);
		let classNo =$(this).children().next().val(); // classNo í´ë˜ìŠ¤ ë²ˆí˜¸
		// console.log(classNo);
		let userNo = $(this).children().next().next().val(); // userNo ìœ ì €ë²ˆí˜¸
		// console.log(userNo);
		
		// ìŠ¤í¬ë© ë“±ë¡ ì²˜ë¦¬
		if (!confirm("ìŠ¤í¬ë© í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
			return;
		}
		
		$.ajax({
	         url:'/scrapInsert.do',
	         type:'post',
	         beforeSend : function(xhr){
					xhr.setRequestHeader(header, token)},
	     	 dataType:'json',
	         data:{categoryId:categoryId, userNo:userNo, boardNo:classNo},
	         success:function(data,idx,arr){
			 	// console.log(arr);
				alert("ìŠ¤í¬ë©ì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.")
	       }
	    })
	})
	
})

</script>
<style>
#pageColor {
	background-color: #6a7964;
	border-color: #6a7964;
	color:white;
}
.page-link {
	color:black;
}
</style>


<title>ì›ë°ì´ í´ë˜ìŠ¤ ëª©ë¡</title>
</head>


<body>

	<article layout:fragment="content">
	<br> <br> <br> <br>
		<!--shop  area start-->
		<div class="shop_section shop_reverse">
			<div class="container">
				<div class="row">
					<div class="col-lg-12 col-md-12">

						<!--breadcrumbs area start-->
						<div class="breadcrumb_content">
							<ul>
								<li><a href="index.html">home</a></li>
								<li>class</li>
							</ul>
						</div>
						<!--breadcrumbs area end-->



						<!--sidebar widget start-->
						<aside class="sidebar_widget">
							<div class="widget_inner">
								<div class="widget_list widget_filter">
									<h2>í´ë˜ìŠ¤ ì°¾ì•„ë³´ê¸°</h2>

									<form method="get" id="classSearchForm" name="classSearchForm">

										
										<!--<div class="sorting_by d-flex align-items-center" id="cl2">
											<span>ì§€ì—­</span>
												<select name="addressRegion" id="addressRegion1"></select> 
												<select name="address" id="addressDo1"></select>
										</div>  -->
										
										
										<div class="filter__list widget_color" id="cl1" style="width: 50%;">
											<h3>ì§€ì—­</h3>

											<div id="addr">
												<div id="img6">
													<input type="radio" name="address" value="ì„œìš¸" id="chk6">
													<label for="chk6">
														<img src="https://mochaclass.com/static/media/location1_default.0894fd94.svg" alt="ì„œìš¸" id="i6">
														<img src="https://mochaclass.com/static/media/location1_over.97f5af5d.svg"  alt="ì„œìš¸" id="i6-1">
													</label>
													<br><a id="a6">ì„œìš¸</a>
												</div>
											</div>

											<div id="addr">
												<div id="img7">
													<input type="radio" name="address" value="ê²½ê¸°" id="chk7">
													<label for="chk7">
														<img src="https://mochaclass.com/static/media/location2_default.2d21abc0.svg" alt="ê²½ê¸°" id="i7">
														<img src="https://mochaclass.com/static/media/location2_over.b610d402.svg" alt="ê²½ê¸°" id="i7-1">
													</label>
													<br><a id="a7">ê²½ê¸°</a>
												</div>
											</div>

											<div id="addr">
												<div id="img8">
													<input type="radio" name="address" value="ë¶€ì‚°" id="chk8">
													<label for="chk8">
														<img src="https://mochaclass.com/static/media/location3_default.d80d2d02.svg" alt="ë¶€ì‚°" id="i8">
														<img src="https://mochaclass.com/static/media/location3_over.e21b9673.svg" alt="ë¶€ì‚°" id="i8-1">
													</label>
													<br><a id="a8">ë¶€ì‚°</a>
												</div>
											</div>

											<div id="addr">
												<div id="img9">
													<input type="radio" name="address" value="ì¸ì²œ" id="chk9">
													<label for="chk9">
														<img src="	https://mochaclass.com/static/media/location4_default.57b7f746.svg" alt="ì¸ì²œ" id="i9">
														<img src="https://mochaclass.com/static/media/location4_over.f45f35fd.svg" alt="ì¸ì²œ" id="i9-1">
													</label>
													<br><a id="a9">ì¸ì²œ</a>
												</div>
											</div>

											<div id="addr">
												<div id="img10">
													<input type="radio" name="address" value="ëŒ€êµ¬" id="chk10">
													<label for="chk10">
														<img src="https://mochaclass.com/static/media/location5_default.388fe582.svg" alt="ëŒ€êµ¬" id="i10">
														<img src="https://mochaclass.com/static/media/location5_over.fb9bf27e.svg" alt="ëŒ€êµ¬" id="i10-1">
													</label>
													<br><a id="a10">ëŒ€êµ¬</a>
												</div>
											</div>
											
											<div id="addr">
												<div id="img11">
													<input type="radio" name="address" value="ìš¸ì‚°" id="chk11">
													<label for="chk11">
														<img src="	https://mochaclass.com/static/media/location6_default.9babe2f2.svg" alt="ìš¸ì‚°" id="i11">
														<img src="https://mochaclass.com/static/media/location6_over.3cd7c8a6.svg" alt="ìš¸ì‚°" id="i11-1">
													</label>
													<br><a id="a11">ìš¸ì‚°</a>
												</div>
											</div>
											
											<div id="addr">
												<div id="img12">
													<input type="radio" name="address" value="ê´‘ì£¼" id="chk12">
													<label for="chk12">
														<img src="	https://mochaclass.com/static/media/location7_default.eb889b28.svg" alt="ê´‘ì£¼" id="i12">
														<img src="https://mochaclass.com/static/media/location6_over.3cd7c8a6.svg" alt="ê´‘ì£¼" id="i12-1">
													</label>
													<br><a id="a12">ê´‘ì£¼</a>
												</div>
											</div>
											
											<div id="addr">
												<div id="img13">
													<input type="radio" name="address" value="ëŒ€ì „" id="chk13">
													<label for="chk13">
														<img src="	https://mochaclass.com/static/media/location8_default.4d3d4dfa.svg" alt="ëŒ€ì „" id="i13">
														<img src="https://mochaclass.com/static/media/location8_over.878e58e6.svg" alt="ëŒ€ì „" id="i13-1">
													</label>
													<br><a id="a13">ëŒ€ì „</a>
												</div>
											</div>
											
											<div id="addr">
												<div id="img14">
													<input type="radio" name="address" value="ì „ë‚¨,ì „ë¶" id="chk14">
													<label for="chk14">
														<img src="	https://mochaclass.com/static/media/location9_default.92e5b652.svg" alt="ê²½ìƒë‚¨ë„" id="i14">
														<img src="https://mochaclass.com/static/media/location9_over.a07f5aec.svg" alt="ê²½ìƒë‚¨ë„" id="i14-1">
													</label>
													<br><a id="a14">ì „ë‚¨ ì „ë¶</a>
												</div>
											</div>
											
											<div id="addr">
												<div id="img15">
													<input type="radio" name="address" value="ê²½ë‚¨,ê²½ë¶" id="chk15">
													<label for="chk15">
														<img src="https://mochaclass.com/static/media/location10_default.ee80bfb5.svg" alt="ê²½ìƒë¶ë„" id="i15">
														<img src="https://mochaclass.com/static/media/location10_over.76d3f6e2.svg" alt="ê²½ìƒë¶ë„" id="i15-1">
													</label>
													<br><a id="a15">ê²½ë‚¨ ê²½ë¶</a>
												</div>
											</div>
											
											<div id="addr">
												<div id="img16">
													<input type="radio" name="address" value="ì œì£¼" id="chk16">
													<label for="chk16">
														<img src="	https://mochaclass.com/static/media/location11_default.4c2666de.svg" alt="ì „ë¼ë‚¨ë„" id="i16">
														<img src="https://mochaclass.com/static/media/location11_over.221d6521.svg" alt="ì „ë¼ë‚¨ë„" id="i16-1">
													</label>
													<br><a id="a16">ì œì£¼</a>
												</div>
											</div>
											
											<div id="addr">
												<div id="img17">
													<input type="radio" name="address" value="ê°•ì›" id="chk17">
													<label for="chk17">
														<img src="https://mochaclass.com/static/media/location12_default.52013261.svg" alt="ì „ë¼ë¶ë„" id="i17">
														<img src="https://mochaclass.com/static/media/location12_over.c2a687ed.svg" alt="ì „ë¼ë¶ë„" id="i17-1">
													</label>
													<br><a id="a17">ê°•ì›</a>
												</div>
											</div>
											
											
										</div>
										
												
										<div class="filter__list widget_color" id="cl2" style="width: 50%;">
											<h3>ì¹´í…Œê³ ë¦¬</h3>

											<div id="cate">
												<div id="img1">
													<input type="checkbox" name="categories" value="food" id="chk1" >
													<label for="chk1"><img src="https://mochaclass.com/static/media/cook.c9477baa.svg" alt="í« í‘¸ë“œ" id="i1"></label>
													<br><a id="a1">í« í‘¸ë“œ</a>
												</div>
											</div>

											<div id="cate">
												<div id="img2">
													<input type="checkbox" name="categories" value="handmade" id="chk2">
													<label for="chk2"><img src="https://mochaclass.com/static/media/craft.13dd03d8.svg" alt="í« í•¸ë“œë©”ì´ë“œ"></label>
													<br><a id="a2">í« í•¸ë“œë©”ì´ë“œ</a>
												</div>
											</div>

											<div id="cate">
												<div id="img3">
													<input type="checkbox" name="categories" value="beauty" id="chk3">
													<label for="chk3"><img src="https://mochaclass.com/static/media/pet.6855bdf3.svg" alt="í« ë¯¸ìš©"></label>
													<br><a id="a3">í« ë¯¸ìš©</a>
												</div>
											</div>

											<div id="cate">
												<div id="img4">
													<input type="checkbox" name="categories" value="drawing" id="chk4">
													<label for="chk4"><img src="https://mochaclass.com/static/media/drawing.04d157cf.svg" alt="í« ë“œë¡œì‰"></label>
													<br><a id="a4">í« ë“œë¡œì‰</a>
												</div>
											</div>

											<div id="cate">
												<div id="img5">
													<input type="checkbox" name="categories" value="etc" id="chk5">
													<label for="chk5"><img src="https://mochaclass.com/static/media/flower.107080ef.svg" alt="ê¸°íƒ€"></label>
													<br><a id="a5">ê¸°íƒ€</a>
												</div>
											</div>
											
										</div>

										<div id="cl3">
											<button type="button" id="classSearch" class="button btn btn-primary"
											style="display:inline-block">í´ë˜ìŠ¤ ê²€ìƒ‰ ğŸ”</button>
											<br><br><br>
										</div>
									</form>
								</div>
							</div>
						</aside>
						<!--sidebar widget end-->



						<div class="shop_banner d-flex align-items-center"
							data-bgimg="assets/img/slider/clslide.jpg">
						</div>
						<!--shop toolbar start-->
						<div
							class="shop_toolbar_wrapper d-flex justify-content-between align-items-center">

							<div class="page_amount col-6">
								<p class="clst">
									<span class="classlist"> [[ ${#lists.size(pageInfo.list)} ]]ê°œì˜
										í´ë˜ìŠ¤ê°€ íšŒì›ë‹˜ì˜ ë“±ë¡ì„ ê¸°ë‹¤ë¦¬ê³  ìˆì–´ìš”!</span>
								</p>
							</div>
							<div class="sorting_by d-flex align-items-center col-6">
								<span>SORT BY </span> <select id="orderby" name="orderby" 
									class="select_option border">
									<option value="1">ìµœì‹ ìˆœ</option>
									<option value="2">ì¸ê¸°ìˆœ</option>
									<option value="3">ê°€ê²©ë†’ì€ ìˆœ</option>
									<option value="4">ê°€ê²©ë‚®ì€ ìˆœ</option>
								</select>
							</div>
						</div>
						<!--shop toolbar end-->

						<div class="row shop_wrapper" id="all">
							<!---------ì‹±ê¸€ ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ ë°˜ë³µë¬¸---------->
							<div class="col-lg-4 col-md-4 col-sm-6 col-6" id="point"
								th:each="c:${pageInfo.list}">

								<div class="single_product">

									<!----ì¸ë„¤ì¼---->
									<div class="product_thumb" id="product_thumb">
										<a th:href="@{classSelect(classNo=${c.classNo})}"> 
											<img th:src="@{display(fileName=${c.thumb})}" alt="consectetur" 
											class="card-img-top embed-responsive-item" id="thumb_img">
										</a>

										<!-- ìŠ¤í¬ë©ê¸°ëŠ¥ ì‹œì‘ 1016 ì„ í¬ ì¶”ê°€ -->
										<div class="product_action">
											<ul>
												<li class="wishlist">
													<a class="scrapBtn" data-tippy="Wishlist"
														data-tippy-inertia="true" data-tippy-delay="50"
														data-tippy-arrow="true" data-tippy-placement="left">
														
														<input type="hidden" th:value="${c.categoryId}" name="categoryId"> 
														<input type="hidden" th:value="${c.classNo}" name="classNo">
														<input type="hidden" th:value="${session.user.userNo}" name="userNo">
														<i class="icon-heart"></i>
													</a>
												</li>
											</ul>
										</div>
										<!--ìŠ¤í¬ë©ê¸°ëŠ¥ ë  -->
									</div>

									<!-----ì„¼í„°ì„¤ëª…------>
									<div class="product_content grid_content text-center">
								
										<div class="clas1">
											<button class="catebtn">[[${c.category}]]</button>
											<br>
											<h4 class="product_name">
												<a class="clasname" th:href="@{classSelect(classNo=${c.classNo})}"
													>[[${c.name}]]</a>
											</h4>
										</div>
										<div class="clas2">
											<h4 class="product_name" >
												<a th:href="@{classSelect(classNo=${c.classNo})}"
													>ğŸ—º [[${c.address}]]</a>
											</h4>
											<div class="price_box">
												<span class="current_price">KRW [[${#numbers.formatInteger(c.price,3,'COMMA')}]]</span>
											</div>
										</div>
										<div class="add_to_cart">
											<a class="btn btn-primary" href="#" data-tippy="Add To Cart"
												data-tippy-inertia="true" data-tippy-delay="50"
												data-tippy-arrow="true" data-tippy-placement="top">í´ë˜ìŠ¤
												ì°œí•˜ê¸°</a>
										</div>
									</div>


								</div>
							</div>
							<!---------ì‹±ê¸€ ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ ë°˜ë³µë¬¸---------->
						</div>
						
												
						 <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
						 <nav aria-label="Page navigation example">
							<ul class="pagination pagination-info  justify-content-center">
								<li class="page-item disabled"
									th:if="${pageInfo.isIsFirstPage()}"><span
									class="page-link">Â«</span></li>
								<li class="page-item"
									th:if="${!pageInfo.isIsFirstPage() && pageInfo.getList().size() > 0}"><a
									class="page-link"
									th:href="|javascript:gopage([[${pageInfo.getPrePage()}]])|"
									rel="prev">Â«</a></li>
								<li
									th:class="|page-item ${(pageInfo.pageNum eq page) ? 'active': ''} |"
									th:each="page:${pageInfo.navigatepageNums}"><span
									class="page-link" th:if="${pageInfo.pageNum eq page}"
									th:text="${page}" id="pageColor"></span> <a class="page-link"
									th:unless="${pageInfo.pageNum eq page}"
									th:href="|javascript:gopage(${page})|" th:text="${page}">{{$page
										}}</a></li>
								<li class="page-item" th:if="${pageInfo.hasNextPage}"><a
									class="page-link"
									th:href="|javascript:gopage([[${pageInfo.getNextPage()}]])|"
									rel="next">Â»</a></li>
								<li class="page-item disabled"
									th:unless="${pageInfo.hasNextPage}"><span
									class="page-link">Â»</span></li>
							</ul>
						</nav>
						
												
						<form id="getOrderBy" action="classList" method="post">
							<div sec:authorize="isAuthenticated()">
								<input type="hidden" th:name="${_csrf.parameterName}"
									th:value="${_csrf.token}"><input type="hidden"
									name="key" id="key">
							</div>
						</form>
						
						<!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
						<script>
		               		function gopage(p) {
		                  		location.href = '/classList?pageNum=' + p;
		                  	}
		               	</script>
						
						<!--shop wrapper end-->
					</div>
				</div>
			</div>
		</div>
		<!--shop  area end-->



	<script>
	var token = $("meta[name='_csrf']").attr("content");
	var header = $("meta[name='_csrf_header']").attr("content");
	
	$("#classSearch").on('click', classSearch)
	
	
	/*-----------------------
	í´ë˜ìŠ¤ ìì—°ì–´ ê²€ìƒ‰
	-------------------------*/	
	
	
	
	
	/*-----------------------
	í´ë˜ìŠ¤ ê°„í¸ ê²€ìƒ‰
	-------------------------*/	
	function classSearch(){
		// ì‚¬ìš©ì IDë¥¼ ê°–ê³  ì˜¨ë‹¤.Â Â Â  
		//var userId = $("#userId").val();

		// 1. ì¹´í…Œê³ ë¦¬ê°€ ê°™ì€ ì²´í¬ë°•ìŠ¤ì˜ ê°’ë“¤ì„ ë°°ì—´ì— ë‹´ëŠ”ë‹¤.
		var categoryCkbox = [];
		$("input[name='categories']:checked").each(function(i) {
			categoryCkbox.push($(this).val());Â Â Â  
		});
		
		// 2. ì…€ë ‰íŠ¸ ì£¼ì†Œ ê°’ë“¤ì„ ë°°ì—´ì— ë‹´ëŠ”ë‹¤.
		var addressCkbox = $("input[name='address']:checked").val();

		// 3. ì‚¬ìš©ì ID(ë¬¸ìì—´)ì™€ ì²´í¬ë°•ìŠ¤ ê°’ë“¤(ë°°ì—´)ì„ name/value í˜•íƒœë¡œ ë‹´ëŠ”ë‹¤.
		var searchData = { 'categories' : categoryCkbox, 'address' : addressCkbox };

				$.ajax({ 
					 url :"classSearch",Â Â Â Â Â Â Â  
					 type :'post', //methodÂ 
					 beforeSend : function(xhr){
						   xhr.setRequestHeader(header, token)},Â Â Â Â Â Â  
					 data : searchData,//$('#classSearchForm').serialize(),Â Â Â Â Â Â Â  
					 //dataType : 'json',
					 success : function(response) {Â Â Â Â Â Â Â Â Â Â Â  
						console.log(categoryCkbox);
					 	console.log(addressCkbox);Â Â Â Â 
					 	
					 	htmlView(response);Â Â Â  
						//window.opener.location.reload();Â Â Â Â Â Â Â Â Â Â Â  
						//self.close();Â Â 
					},Â Â Â Â Â Â Â  
					 error:function(){Â Â Â Â Â Â 
						 console.log('ì˜¤ë¥˜');Â Â Â Â Â  Â Â Â Â Â  
					 }
				 
				})
		
		function htmlView(datas) {
			$(".shop_wrapper").empty();Â 
			$(".clst").empty();
			
			var length = datas.length;
			var newlength = `<span class="classlist"> ${length} ê°œì˜
				í´ë˜ìŠ¤ê°€ íšŒì›ë‹˜ì˜ ë“±ë¡ì„ ê¸°ë‹¤ë¦¬ê³  ìˆì–´ìš”!</span>`
			$(".clst").append(newlength);
				
			for (c of datas){
			var result = `<div class="col-lg-4 col-md-4 col-sm-6 col-6" id="point">
				
							<div class="single_product">
								<!----ì¸ë„¤ì¼?---->
								<div class="product_thumb"  id="product_thumb">
									<a href="/classSelect?classNo=${c.classNo}"> 
										<img class="primary_img"  id="thumb_img" src="display?fileName=${c.thumb}" alt="consectetur" class="card-img-top embed-responsive-item">
									</a>
									
									<div class="product_action">
										<ul>
											<li class="wishlist"><a href="#" data-tippy="Wishlist"
												data-tippy-inertia="true" data-tippy-delay="50"
												data-tippy-arrow="true" data-tippy-placement="left"><i
													class="icon-heart icons"></i></a></li>
										</ul>
									</div>
								</div>				
			
								<!-----ì„¼í„°ì„¤ëª…------>
								<div class="product_content grid_content text-center">
									<div class="clas1">
										<button class="catebtn">${c.category}</button>
										<br>
										<h4 class="product_name">
											<a class="clasname" href="/classSelect?classNo=${c.classNo}">${c.name}</a>
										</h4>
									</div>
									
									<div class="clas2">
										<h4 class="product_name">
											<a href="/classSelect?classNo=${c.classNo}">ğŸ—º ${c.address}</a>
										</h4>
										<div class="price_box">
											<span class="current_price">KRW ${c.price}</span>
										</div>
										
									</div>
									
									<div class="add_to_cart">
										<a class="btn btn-primary" href="#" data-tippy="Add To Cart"
											data-tippy-inertia="true" data-tippy-delay="50"
											data-tippy-arrow="true" data-tippy-placement="top">í´ë˜ìŠ¤ ì°œí•˜ê¸°</a>
									</div>
								</div>
			
			
							</div>
						</div>`	
				$(".shop_wrapper").append(result);Â 

			}
		}		
	};

	</script>
	</article>
</body>
</html>