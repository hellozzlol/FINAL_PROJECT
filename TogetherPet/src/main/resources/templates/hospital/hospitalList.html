<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout}">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
	crossorigin="anonymous">
<head>
<meta charset="UTF-8">
<meta id="_csrf" name="_csrf" th:content="${_csrf.token}" />
<meta id="_csrf_header" name="_csrf_header"
	th:content="${_csrf.headerName}" />




<style>
.btn {
	text-align: center;
	display: inline-block;
	position: Â absolute;
}

form {
	text-align: center;
	display: inline-block;
	position: Â absolute;
}
</style>
<title>ë™ë¬¼ë³‘ì›</title>



</head>
<body>
	<article layout:fragment="content">
		<!--shop  area start-->
		<div class="shop_section shop_reverse">
			<div class="container">
				<div class="row">
					<div class="col-lg-12 col-md-12">

						<!--breadcrumbs area start-->
						<div class="breadcrumb_content" style="margin: 50px;">
							<ul>
								<li><a href="index.html">home</a></li>
								<li>Petinfo</li>
								<li>Hospital</li>
							</ul>
						</div>
						<!--breadcrumbs area end-->



						<script>
						document.addEventListener('DOMContentLoaded', function() {
							var token = $("meta[name='_csrf']").attr("content");
							var header = $("meta[name='_csrf_header']").attr("content");
					// í•„í„°ë§
					// ë°°ë„ˆë¥¼ í´ë¦­í–ˆì„ ë•Œ ë°°ë„ˆ ê°’ì´ë‘ ì¹´í…Œê³ ë¦¬ ê°’ì´ë‘ ë‹¤ë¥´ë©´ display:none ìŠ¤íƒ€ì¼ ì¶”ê°€
						$('#category').on('click', 'button', function() {
								let filter = $(this).data('filter');
								let categories = $('.category') // <div> íƒœê·¸ ë°°ì—´
			
							for(category of categories){ 
							category.style='';
								if(filter == 'ALL'){
										category.style='';
								}else if(category.getAttribute('data-category') != filter){
									category.style.display='none';
											}
										}
									})
		
								})
						</script>


						<!-- ì¹´í…Œê³ ë¦¬ ì‹œì‘  -->

						<div id="category"
							class="blog_messonry_button d-flex justify-content-center"
							style="margin-top: 100px;">

							<button class="active" data-filter="ALL">
								<img
									src="https://img.icons8.com/sf-regular-filled/50/1A1A1A/a.png" /><br>ì „ì²´
							</button>

							<button data-filter="DAEGU">
								<img
									src="https://cdn.clien.net/web/api/file/F01/8384364/fe733d011dfc7.gif?w=390&h=30000"
									width="100" height="100" /><br>ëŒ€êµ¬
							</button>

							<button data-filter="GWANGJU">
								<img
									src="https://t1.daumcdn.net/thumb/R720x0.fjpg/?fname=http://t1.daumcdn.net/brunch/service/user/7Cdd/image/f3nuEtGBejVIyewzBIHl3L2aSB4.jpg"
									width="100" height="100" /><br>ê´‘ì£¼
							</button>

							<button data-filter="SEOUL">
								<img
									src="https://www.seoul.go.kr/seoulcom/fileDownload.do?fileName=symbol/icon4.png"
									width="100" height="100" /><br>ì„œìš¸
							</button>


							<button data-filter="GYEONGGIDO">
								<img
									src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSTQJPhWeL8QO6SNNjHJXj14PRAIFczcQXW0Q&usqp=CAU"
									width="100" height="100" /><br>ê²½ê¸°ë„
							</button>

						</div>

						<!-- ì¹´í…Œê³ ë¦¬ ë  -->




					<div class="shop_banner d-flex align-items-center"
							data-bgimg="assets/img/bg/hos5.jpg">
							<div class="shop_banner_text">
							</div>
						</div>



						<h1>ë™ë¬¼ë³‘ì› ì¡°íšŒ</h1>
						<br>
						<h3>íˆ¬ê²Œë” í« ì—ì„œ ,ì „êµ­ì—ìˆëŠ” ë™ë¬¼ë³‘ì›ì„ ì¡°íšŒí•´ë³´ì•„ìš”ğŸ¾</h3>
						<br> <br>
						<!-- ê²€ìƒ‰ê¸°ëŠ¥ ì‹œì‘  -->
						<form class="row gy-2 gx-3 align-items-center" id="btn">
							<div class="col-auto">
								<select id="key" name="key">
									<option value="1">ì§€ì—­</option>
									<option value="2">ë³‘ì›ëª…</option>
								</select>
							</div>

							<div class="col-auto">
								<input class="form-control" type="text" id="val" name="val">
							</div>
							<div class="col-auto">
								<button type="button" class="btn btn-dark" id="Serachbtn"
									onclick="searchCall()">ê²€ìƒ‰</button>
							</div>
						</form>
						<!-- ê²€ìƒ‰ê¸°ëŠ¥ ë  -->
						<br> <br> <br>



						<!-- ë³‘ì›ë¦¬ìŠ¤íŠ¸ ë°˜ë³µë¬¸ ì‹œì‘ -->
						<div class="row shop_wrapper" id="all">
							<div th:each="h : ${hospital}"
								class="col-lg-4 col-md-4 col-sm-6 col-6 category"
								style="width: 18rem;" th:data-category="${h.category}">
								<div class="embed-responsive embed-responsive-4by3">
									<img th:src="${h.hphoto}"
										class="card-img-top embed-responsive-item" alt="tree">

									<!--ìŠ¤í¬ë©ê¸°ëŠ¥ ì‹œì‘  -->
									<div class="product_action">
										<ul>
											<li class="wishlist">
											<a href="#" data-tippy="Wishlist"
												data-tippy-inertia="true" data-tippy-delay="50"
												data-tippy-arrow="true" data-tippy-placement="left"> 
											
												<input type="hidden" th:value="${h.categoryId}" name="categoryId"> 
												<input type="hidden" th:value="${h.hospitalNo}" name="boardNo">
												<input type="hidden" th:value="${session.user.userNo}" name="userNo">
													<i class="icon-heart scrapBtn"></i>
											</a></li>
										</ul>
									</div>

									<!--ìŠ¤í¬ë©ê¸°ëŠ¥ ë  -->


								</div>
								<div class="card-body">
									<h5 class="card-title">ğŸ¶[[${h.name}]]</h5>
									<p class="card-text">â°[[${h.workingHour}]]</p>
									<p class="card-text" th:text="${h.address}"></p>
									<p class="card-text">ğŸ˜„[[${h.hit}]]</p>
									<a th:href="@{hospital(hospitalNo=${h.hospitalNo})}"
										class="btn btn-primary">ë”ë³´ê¸°</a>
								</div>
							</div>
						</div>
						<!-- ë³‘ì›ë¦¬ìŠ¤íŠ¸ ë°˜ë³µë¬¸ ë -->


						<!-- ìŠ¤í¬ë© ìŠ¤í¬ë¦½íŠ¸ ì‹œì‘ 20221005 ì†Œí˜„ ì¶”ê°€  -->

						<script>
													
						var token = $("meta[name='_csrf']").attr("content");
						var header = $("meta[name='_csrf_header']").attr("content");
												    
						//ìŠ¤í¬ë© í•˜íŠ¸ë²„íŠ¼ í´ë¦­ì‹œ
	
						$("#all").on('click','.icon-heart', function() {
						
							alert('ìŠ¤í¬ë© í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')
									
							let categoryId = $(this).prev().prev().prev().val();//ë³‘ì›ì¹´í…Œê³ ë¦¬ h
							console.log('ì¹´í…Œê³ ë¦¬->',$(this).prev().prev().prev().val());
							
							let boardNo =$(this).prev().prev().val();//boardNo ë³‘ì›ë²ˆí˜¸
							console.log('ë³‘ì›ë²ˆí˜¸->',$(this).prev().prev().val());
							
							
							let userNo = $(this).prev().val();// userNo ìœ ì €ë²ˆí˜¸
							console.log('ìœ ì €ë²ˆí˜¸->',$(this).prev().val());
							
							
							
							//ìŠ¤í¬ë© ë“±ë¡ ì²˜ë¦¬
							$.ajax({
						         url:'/scrapInsert.do',
						         type:'post',
						         beforeSend : function(xhr){
										xhr.setRequestHeader(header, token)},
						     	 dataType:'json',
						         data:{categoryId:categoryId, userNo:userNo, boardNo:boardNo},
						         success:function(data,idx,arr){
								console.log(arr); 
			
									alert("ìŠ¤í¬ë©ì´ ì„±ê³µ ì  ìœ¼ë¡œ ë“±ë¡ ë˜ì—ˆìŠµë‹ˆë‹¤.")
							
						       }
						    })
								
						})
						
						
						</script>
						<!-- ìŠ¤í¬ë© ìŠ¤í¬ë¦½íŠ¸ ì‹œì‘ 20221005 ì†Œí˜„ ë  -->


					</div>
				</div>
			</div>
		</div>



		<!-- ê²€ìƒ‰ì•„ì‘ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ ì‹œì‘  -->
		<script>
		
		$("#Serachbtn").on('click', searchCall)
		
		var token = $("meta[name='_csrf']").attr("content");
		var header = $("meta[name='_csrf_header']").attr("content");
	
		function searchCall() {
			  let key = document.getElementById('key').value;
		      let val = document.getElementById('val').value;
		     
		     
		     $.ajax({
		    	url : "hospitalajaxSearch",
		    	type : 'get',//method
		    	beforeSend : function(xhr){
				xhr.setRequestHeader(header, token)},
		    	data : {'key' : key, 'val' : val},
		    	dataType : 'json',
		    	success : function(response) {
					console.log(response);
					htmlView(response);
				},
				error : function () {
					console.log('ì˜¤ë¥˜');Â Â Â 
				}
		     });
		     
		     function htmlView(data) {
					//htmlë¡œ ë³€í™˜í•´ì„œ ì›í•˜ëŠ” ìœ„ì¹˜ì— ì¶œë ¥í•˜ë„ë¡ êµ¬í˜„
					
					 $(".shop_wrapper").empty();Â 
					 //$(".host").remove();Â 
					 
				
					 for(h of data) {
					
						 var result = `
								<div class="col-lg-4 col-md-4 col-sm-6 col-6 category" id="point" style="width: 18rem;">
								<div class="embed-responsive embed-responsive-4by3">
								<img src="${h.hphoto}"class="card-img-top embed-responsive-item" alt="tree">
								</div>
								<div class="card-body">
									<h5 class="card-title">${h.name}</h5>
									<p class="card-text">â°${h.workingHour}</p>
									<p class="card-text">${h.address}</p>
									<p class="card-text">ì¡°íšŒìˆ˜${h.hit}</p>
									<a href="hospital?hospitalNo=${h.hospitalNo}"
										class="btn btn-primary">ë”ë³´ê¸°</a>
								</div>
							</div>
						</div>`
							 $(".shop_wrapper").append(result);Â 	
							//$(".host").append(".card-body");
					 
					 		};	
					 	};
					     
					};
		</script>
		<!-- ê²€ìƒ‰ì•„ì‘ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ ë  -->
	</article>
</body>
</html>