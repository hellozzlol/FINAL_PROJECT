<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout2}">
<head>
<meta charset="UTF-8">
<title>ë™ë¬¼ë³‘ì›</title>


<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>
<script>
	/*-----------------------
	//ë³„ì  í´ë¦­ ì‹œ ë³„ì  ì¡°ì •	
	-------------------------*/
	$(document).on('click', '.fa-star', function(evt) {
		console.log('ì‹¤í–‰');
		var idxS = $(this).index();
		console.log(idxS);
		for (var i = 0; i <= idxS; i++) { // ë³„ì  ì±„ìš°ê¸°
			$('.star-point').children().eq(i).css('color', '#FFB300');
		}
		for (var i = 4; i > idxS; i--) { // ë³„ì  ë¹„ìš°ê¸°
			$('.star-point').children().eq(i).css('color', '#d3d3d3');
		}
		$('#star').val(idxS + 1);
		$('.star-txt').html('<span>' + (idxS + 1) + '</span><span>ì </span>');

	});
</script>


<style>
.btn {
	margin: auto;
	display: block;
}
/*================ ë³„ì  ===============*/
.star-point:before {
	display: none;
}

.star-point {
	font-size: 54px;
	text-align: center;
	letter-spacing: -3px;
}

.star-point .fa-star {
	cursor: pointer;
	color: #d3d3d3;
}

.star-txt {
	height: 41px;
	padding-top: 8px;
	text-align: center;
	color: #999;
	font-size: 16px;
}

.star-txt>span:first-child {
	color: #ff385c;
	font-size: 27px;
	font-weight: 700;
}

.star-txt>span:nth-child(2) {
	color: #ff385c;
	font-size: 18px;
	font-weight: 700;

}
.reviewstar {
	font-size: xx-large;
	color: #ffd700;
}

</style>
</head>
<body>
	<article layout:fragment="content">
		<!--shop  area start-->
		<div class="shop_section shop_reverse">
			<div class="container">
				<div class="row">
					<div class="col-lg-12 col-md-12">

						<!--breadcrumbs area start-->
						<div class="breadcrumb_content" style="margin: 50px;">
							<ul>
								<li><a href="index.html">home</a></li>
								<li>Petinfo</li>
								<li>hospital</li>
							</ul>
						</div>
						<!--breadcrumbs area end-->

						<div class="shop_banner d-flex align-items-center"
							data-bgimg="assets/img/bg/pexels-photo-59523.jpeg">
							<div class="shop_banner_text">
								<h2>
									essential <br> for my pets
								</h2>
								<p>
									The collections basic items <br> essential for all pets
								</p>
							</div>
						</div>




						<!--product details start-->
						<section class="product_details mb-135">
							<div class="container">
								<div class="row">
									<div class="col-lg-6 col-md-6">
										<div class="product_zoom_gallery">
											<div class="zoom_gallery_inner d-flex">

												<div class="product_zoom_main_img" th:each="h:${hospital}">
													<div class="product_zoom_thumb">
														<img th:src="${h.hphoto}" alt="tab-thumb">
													</div>
												</div>
											</div>
										</div>
									</div>
									<div class="col-lg-6 col-md-6">
										<div class="product_d_right" th:each="h:${hospital}">

											<h1 th:text="${h.name}">ë³‘ì›</h1>
											<br>
											<div class="product_ratting_review d-flex align-items-center">
												<div class="product_review">
													<ul>
														<li>ğŸ“[[${#lists.size(ReviewSelectList)}]]ê°œì˜ ë¦¬ë·°ê°€ ìˆìŠµë‹ˆë‹¤.</li>
													</ul>
												</div>
											</div>

											<div class="product_sku">
											
												<p>
													<span>ì „í™”ë²ˆí˜¸ : </span> [[${h.call}]]
												</p>
											
												<p>
													<span>ì „ë¬¸ê³¼ëª©: </span> [[${h.info}]]
												</p>
												<p>
													<span>ì§„ë£Œì‹œê°„: </span> [[${h.workingHour}]]
												</p>
												<p>
													<span>ì£¼ ì†Œ: </span> [[${h.address}]]
												</p>
												<p>
													<span>ëŒ€í‘œìˆ˜ì˜ì‚¬: </span> [[${h.vet}]]
												</p>
											</div>
										</div>
									</div>
								</div>
							</div>
						</section>
						<!--product details end-->


						<!--product info start-->
						<div class="product_d_info mb-118">
							<div class="container">
								<div class="row">
									<div class="col-12">
										<div class="product_d_inner">
											<div class="product_info_button border-bottom">
												<ul class="nav" role="tablist">
													<li><a class="active" data-toggle="tab" href="#info"
														role="tab" aria-controls="info" aria-selected="false">ë³‘ì›ì •ë³´</a>
													</li>
													<li><a data-toggle="tab" href="#reviews" role="tab"
														aria-controls="reviews" aria-selected="false">í›„ê¸° </a></li>


												</ul>
											</div>
											<div class="tab-content">
												<div class="tab-pane fade show active" id="info"
													role="tabpanel" th:each="h:${hospital}">
													<div class="product_info_content">
														<p th:text="${h.name}">ì—¬ê¸° ë³‘ì›ì†Œê°œ í•´ì£¼ì„¸ìš©.</p>
														<ul>
															<li>ìš°ë¦¬ì•„ì´ê°€ ì•„í”Œë•Œ ì œì¼ë¨¼ì € ìƒê°ë‚˜ëŠ” ë³‘ì›ì´ ë˜ë„ë¡í•˜ê² ìŠµë‹ˆë‹¤</li>
															<li>ì£¼ì°¨ì¥ë³´ìœ </li>
															<li>ì§„ë£ŒëŠ” ë¯¸ë¦¬ ì „í™”ì£¼ì‹œë©´ ë¹ ë¥´ê²Œ ë³´ì‹¤ìˆ˜ ìˆìœ¼ì‹­ë‹ˆë‹¤.</li>
															<li>ê°•ì•„ì§€,ê³ ì–‘ì´ ì§„ë£Œê°€ëŠ¥</li>
															<li>ì˜ì–´ê°€ëŠ¥</li>
														</ul>
													</div>
													<input type="hidden" th:value="${h.hospitalNo}" name="boardNo" id="hospitalNo">
												</div>
												
								<!-- ë¦¬ë·° -->
								<div class="tab-pane fade" id="reviews" role="tabpanel">
									<div class="reviews_wrapper">
										<h2>[[${#lists.size(ReviewSelectList)}]]ê°œì˜ ë¦¬ë·°ê°€ ìˆìŠµë‹ˆë‹¤.</h2>
										
										<!-- ë§í’ì„  ëª¨ì–‘ div -->
										<div class="reviews_comment_box" th:each="re:${ReviewSelectList}">
											<div class="comment_thmb">
												<img src="assets/img/blog/comment2.jpg" alt="">
											</div>
											<div class="comment_text">
												<div class="reviews_meta">
													<p>
														<strong th:switch="${re.star}">
															<i class="reviewstar" th:case="5">â˜…â˜…â˜…â˜…â˜…</i>
															<i class="reviewstar" th:case="4">â˜…â˜…â˜…â˜…â˜†</i>
															<i class="reviewstar" th:case="3">â˜…â˜…â˜…â˜†â˜†</i>
															<i class="reviewstar" th:case="2">â˜…â˜…â˜†â˜†â˜†</i>
															<i class="reviewstar" th:case="1">â˜…â˜†â˜†â˜†â˜†</i>
															<i class="reviewstar" th:case="0">â˜†â˜†â˜†â˜†â˜†</i>
														</strong><br>
														
														<strong>[[${re.nickname}]]</strong> 
														<a>  [[${re.dt}]]</a>
													</p>
													<span>[[${re.content}]]</span>
												</div>
											</div>
										</div>
										<!-- ë§í’ì„  ëª¨ì–‘ div -->
										
										<!-- ajaxë¡œ ëŒ“ê¸€ ë‹¬ë¦¬ëŠ” ë¶€ë¶„ -->
										<div class="reviews_comment_box" id="ajaxReviewDiv"></div>
										
										
										<div class="product_review_form">	
												<div class="product_ratting mb-10">
													<h2 class="star-txt">ë³„ì ì„ ì„ íƒí•´ì£¼ì„¸ìš”</h2>
													<div class="star-point">
														<i class="fa-star">â˜…</i> <i class="fa-star">â˜…</i> <i
															class="fa-star">â˜…</i> <i class="fa-star">â˜…</i> <i
															class="fa-star">â˜…</i>
													</div>
													
													<!-- ë³„ì  ìˆ«ì -->
													<input type="hidden" id="star" name="star" value="0" />
		
												</div>
											
												<div class="row">
													<div class="comment_title col-12">
														<h2>ë³‘ì›í›„ê¸°ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”</h2>
														<!-- ë§í’ì„  ëª¨ì–‘ div -->
														<div class="reviews_comment_box">
															<div class="comment_thmb">
																<img src="assets/img/blog/comment2.jpg" alt="">
															</div>
															<div class="comment_text">
																<div class="reviews_meta">
																	<p>
																		<strong th:value="${session.user.nickname}"></strong> 
																	</p>
																	<span>
																		<textarea id="reviewcontent" name="content" rows="8" cols="8" style="border:none;"></textarea>
																	</span>
																</div>
															</div>
															<button id="reviewbtn" type="button">ì‘ì„±í•˜ê¸°</button>
														</div>
														<!-- ë§í’ì„  ëª¨ì–‘ div -->
													</div>
												</div>
										    </div>
									    </div>
								   </div>
								   
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>


				</div>

				<div id="btn">
					<button type="button" class="btn btn-dark"
						onclick="location.href='hospitalList'">ëª©ë¡ê°€ê¸°</button>
				</div>
			</div>
		</div>
			<script>
		
		
		/*-----------------------
		//ëŒ“ê¸€ ì‘ì„±
		-------------------------*/				
		$('#reviewbtn').on("click", function() {
				var token = $("meta[name='_csrf']").attr("content");
				var header = $("meta[name='_csrf_header']").attr("content");
			
				var title = "ë³‘ì› í›„ê¸°";
				var content = $("#reviewcontent").val();
				var star = $("#star").val();
				var boardNo = $("#hospitalNo").val();
				var categoryId = "h";
				var groupNo = 1;
				var userNo = $("#userNo").val();

			 	$.ajax({
						url : "hospitalReviewInsert",
						type:'post',
						beforeSend: function (xhr) {
							xhr.setRequestHeader(header, token)
						},
						data : {
								title:title,
								content:content,
								star:star,
								boardNo: boardNo,
								categoryId:categoryId,
								groupNo:groupNo,
								userNo:userNo
								},
						success : function(result){
							$("#ajaxReviewDiv").append(
								`<div class="comment_thmb">
											<img src="assets/img/blog/comment2.jpg" alt="">
								</div>
								<div class="comment_text">
											<div class="reviews_meta">
												<p>
													<strong id="starbox">
													</strong><br>
													
													<strong>${result.nickname}</strong> 
													<a> ${result.dt}</a>
												</p>
												<span>${result.content}</span>
											</div>
										</div>
								</div>`
							);
							
							var rank = `${result.star}`
							console.log(rank)
							
							if(rank == 5) {
								$("#starbox").append(`<i class="reviewstar">â˜…â˜…â˜…â˜…â˜…</i>`);
							} else if(rank ==4) {
								$("#starbox").append(`<i class="reviewstar">â˜…â˜…â˜…â˜…â˜†</i>`);
							} else if(rank ==3) {
								$("#starbox").append(`<i class="reviewstar">â˜…â˜…â˜…â˜†â˜†</i>`);
							} else if(rank ==2) {
								$("#starbox").append(`<i class="reviewstar">â˜…â˜…â˜†â˜†â˜†</i>`);
							} else if(rank ==1) {
								$("#starbox").append(`<i class="reviewstar">â˜…â˜†â˜†â˜†â˜†</i>`);
							} else if(rank ==0) {
								$("#starbox").append(`<i class="reviewstar">â˜†â˜†â˜†â˜†â˜†</i>`);
							}

							alert("ë¦¬ë·°ê°€ ì„±ê³µì ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.")
						
						},
						error : function(result){
							alert("ë¦¬ë·°ë¥¼ ì‘ì„±í•˜ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")
						}
				}); 
			 	
		})
		</script>
	</article>
	

</body>
</html>